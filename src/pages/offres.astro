---
import Layout from "../layouts/Layout.astro";
import OffreCard from "../components/OffreCard.astro";
import Image1 from "../assets/image1.avif";
import { getOffres } from "../js/backend.mjs";
const offres = await getOffres();
---

<Layout titre="Accueil">
    <h1>Offres</h1>
    <button
        id="favori-button"
        class="bg-amber-400 hover:bg-amber-500
           text-red-900 font-semibold
           px-6 py-3
           rounded-xl
           shadow-md hover:shadow-lg
           transition-all duration-200
           hover:-translate-y-0.5 active:translate-y-0
           mt-8 ml-8"
    >
        Afficher les favoris
    </button>

    {
        offres.map((offre) => (
            <div class="offre" data-favori={offre.favori.toString()}>
                <OffreCard offre={offre} />
            </div>
        ))
    }
</Layout>
<script>
    const button = document.getElementById("favori-button");
    let showOnlyFavorites = false;

    button?.addEventListener("click", () => {
        showOnlyFavorites = !showOnlyFavorites;
        const offres: NodeListOf<HTMLElement> =
            document.querySelectorAll(".offre");

        offres.forEach((offre) => {
            const isFavori = offre.dataset.favori === "true";

            if (showOnlyFavorites) {
                offre.style.display = isFavori ? "block" : "none";
                button.textContent = "Afficher tout";
            } else {
                offre.style.display = "block";
                button.textContent = "Afficher les favoris";
            }
        });
    });
</script>
